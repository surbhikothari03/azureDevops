trigger:
- none  # Manual trigger

variables:
  acrLoginServer: 'azuredevops.azurecr.io'
  acrUsername: 'azuredevops'
  # acrPassword is secret — stored in pipeline UI

pool:
  name: Default

jobs:
- job: TestAcrLogin
  steps:
  - script: |
      echo "Logging in to ACR..."
      echo "$ACR_PASSWORD" | docker login $ACR_LOGIN_SERVER -u $ACR_USERNAME --password-stdin

      echo "Verifying login with docker info..."
      docker info

      echo "Testing image pull (you can change image name if needed)..."
      docker pull $ACR_LOGIN_SERVER/azuredevops:latest || echo "Pull failed — image might not exist, but login was tested"
    env:
      ACR_LOGIN_SERVER: $(acrLoginServer)
      ACR_USERNAME: $(acrUsername)
      ACR_PASSWORD: $(acrPassword)
    displayName: 'Test ACR Authentication'
